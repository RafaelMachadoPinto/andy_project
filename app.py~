from wsgiref.simple_server import make_server
from pyramid.config import Configurator
from pyramid.response import Response
from pyramid.static import static_view


def load_html(request):
    
    #print request.POST
    client_name = request.matchdict['client_name']
    game_name = request.matchdict['game_name']
    _resp = Response()

    if client_name == "openbet" or client_name == "spacebar" or client_name == "nyx": 
      path = 'games/'+game_name+'/index.html'
      #_resp.app_iter = open(path,'r')
      file = open(path,'r')
     
      str = "I'm adding this text to index.html " 
      for line in file:
        str += line
      _resp.body = str
      return _resp
    
    
def piradinha(request):
   client_name = request.matchdict['client_name']
   game_name = request.matchdict['game_name']
   _resp = Response()
   www = static_view('games/'+game_name+'/'+client_name, use_subpath=True)
   print www
   return _resp
 
if __name__ == '__main__':
    config = Configurator()
    config.add_route('games', '/games/{game_name}/{client_name}')
    config.add_view(load_html, route_name='games')

    config.add_static_view(name='games', path='games/')

    app = config.make_wsgi_app()
    server = make_server('0.0.0.0', 8080, app)
    server.serve_forever()




